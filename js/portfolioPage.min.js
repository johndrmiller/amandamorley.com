function parseURL(){let e,t,i=new URLSearchParams(window.location.search),a=i.get("image");t=galleriesArray.find(function(t){return[...[...t.children][0].children].find(function(t){return t.dataset.append==a&&(e=t),t.dataset.append==a})}),tabSwitchOnOpen(t),imagePreviewOnOpen(e)}function imagePreviewOnOpen(e){e.addEventListener("notClick",openImagePreview,{once:!0}),e.dispatchEvent(new CustomEvent("notClick",{}))}function tabSwitchOnOpen(e){let t=portfolioNavArray.find(function(t){return t.dataset.gallery==e.id});t.addEventListener("notClick2",changeGallery,{once:!0}),t.dispatchEvent(new CustomEvent("notClick2",{}))}async function changeGallery(e){const t=await pickNewGallery(e);t.clickedTab!=currentTab&&(t.nextGallery.style.opacity=0,groupListeners([{ele:portfolioNavArray,ev:"click",fun:changeGallery,action:"remove"},{ele:galleryImages,ev:"click",fun:openImagePreview,action:"remove"}]),closeOldGallery().then(()=>{openNewGallery(t.nextGallery)}).then(()=>{cleanupAndReset(t)}))}function pickNewGallery(e){let t=e.target,i=galleriesArray.filter(e=>e.id==t.dataset.gallery)[0];return{clickedTab:t,nextGallery:i}}async function closeOldGallery(){return currentGallery.classList.add("gallery-fade-out"),new Promise((e,t)=>{currentGallery.addEventListener("animationend",function(t){e()},{once:!0})})}async function openNewGallery(e){return e.classList.add("showingGallery","gallery-fade-in"),new Promise((t,i)=>{e.addEventListener("animationend",function(e){t()},{once:!0})})}function cleanupAndReset(e){currentTab.classList.remove("selectedGallery"),e.clickedTab.classList.add("selectedGallery"),currentGallery.classList.remove("showingGallery","gallery-fade-out"),e.nextGallery.classList.remove("gallery-fade-in"),currentTab=e.clickedTab,currentGallery=e.nextGallery,galleryImages=[...currentGallery.getElementsByClassName("galleryImages")[0].children],lastGalleryIndex=galleryImages.length-1,currentGallery.style="",groupListeners([{ele:portfolioNavArray,ev:"click",fun:changeGallery,action:"add"},{ele:galleryImages,ev:"click",fun:openImagePreview,action:"add"}])}function openImagePreview(e){let t,i=e.target.closest(".galleryImage");console.log(i),currentImageIndex=galleryImages.indexOf(i),imagePreview.style.opacity=0,imagePreview.style.display="flex",imageEnlargement.addEventListener("load",function(e){imageCalcs(e).then(()=>{imagePreview.addEventListener("animationend",finalizeImagePreview,{once:!0}),imagePreview.classList.add("image-details-appear"),closeBox.addEventListener("click",closePreview)})},{once:!0}),imageEnlargement.src=i.dataset.imageFile,imageTitle.textContent=i.dataset.imageName,t=`${window.location.href}?image=${i.dataset.append}`,history.pushState(null,null,t)}async function imageCalcs(e){let t,i,a,n,r=window.getComputedStyle(imageArea),o=parseInt(r.height),l=parseInt(r.width);return imageProportion=imageEnlargement.naturalWidth/imageEnlargement.naturalHeight,groupListeners([{ele:window,ev:["scroll","wheel","touchmove"],fun:stopZoomScroll,action:"add",opts:{passive:!1}}]),imageProportion<=1?(a=.9*o,n=imageProportion*a):imageProportion>1&&(n=.9*l,a=n/imageProportion),imageProportion<=1&&l>n||imageProportion>1&&o<a?imageContainer.style.height="90%":(imageProportion>1&&o>a||imageProportion<=1&&l<n)&&(imageContainer.style.width="90%"),window.visualViewport.scale>1&&scaleCorrection(),t=window.getComputedStyle(imageContainer),i=parseInt(t.width)/parseInt(t.height),imageContAdjustment(imageProportion,i,t.width,t.height),new Promise((e,t)=>{e()})}function scaleCorrection(){let e=1/window.visualViewport.scale,t=window.getComputedStyle(imagePreview),i=window.getComputedStyle(previewHeader);imagePreview.style.width=`${100*e}vw`,imagePreview.style.height=`${100*e}vh`,imagePreview.style.top=`${window.visualViewport.offsetTop}px`,imagePreview.style.left=`${window.visualViewport.offsetLeft}px`,imagePreview.style.fontSize=`${parseInt(t.getPropertyValue("font-size"))*e}px;`,previewHeader.style=`padding-top: ${parseInt(i.getPropertyValue("padding-top"))*e}px; padding-bottom: ${parseInt(i.getPropertyValue("padding-bottom"))*e}px;`}function imageContAdjustment(e,t,i,a){t<e?imageContainer.style.height=parseInt(i)*(1/e)+"px":imageContainer.style.width=e*parseInt(a)+"px"}function stopZoomScroll(e){e.preventDefault()}function finalizeImagePreview(e){imagePreview.style.opacity=1,imagePreview.classList.remove("image-details-appear"),groupListeners([{ele:imageArea,ev:["pointerup","pointercancel","pointerout","pointerleave"],fun:pointerup_handler,action:"add"},{ele:imageArea,ev:"pointerdown",fun:pointerdown_handler,action:"add"},{ele:imageArea,ev:"pointermove",fun:pointermove_handler,action:"add"},{ele:imageArea,ev:"wheel",fun:wheel_handler,action:"add"},{ele:imagePreviewNavButtons,ev:"click",fun:changeImage,action:"add"}])}function closePreview(e){imagePreview.style=previewHeader.style=imageContainer.style="",history.replaceState(null,null,"portfolio.html"),groupListeners([{ele:imageArea,ev:["pointerup","pointercancel","pointerout","pointerleave"],fun:pointerup_handler,action:"remove"},{ele:window,ev:["scroll","wheel","touchmove"],fun:stopZoomScroll,action:"remove",opts:{passive:!1}},{ele:imageArea,ev:"pointerdown",fun:pointerdown_handler,action:"remove"},{ele:imageArea,ev:"pointermove",fun:pointermove_handler,action:"remove"},{ele:imageArea,ev:"wheel",fun:wheel_handler,action:"remove"},{ele:imagePreviewNavButtons,ev:"click",fun:changeImage,action:"remove"}])}function changeImage(e){switch(groupListeners([{ele:imagePreviewNavButtons,ev:"click",fun:changeImage,action:"remove"}]),e.currentTarget){case previousButton:0==currentImageIndex?currentImageIndex=lastGalleryIndex:currentImageIndex-=1;break;case nextButton:currentImageIndex==lastGalleryIndex?currentImageIndex=0:currentImageIndex+=1}imageEnlargement.addEventListener("animationend",openNewImage,{once:!0}),imageEnlargement.classList.add("image-details-disappear")}function openNewImage(){let e=galleryImages[currentImageIndex];imageEnlargement.style.opacity="0",imageEnlargement.classList.remove("image-details-disappear"),imageEnlargement.addEventListener("load",function(e){imageCalcs(e).then(()=>{imageEnlargement.addEventListener("animationend",imageChangeWrapUp),imageEnlargement.classList.add("image-details-appear")})},{once:!0}),(imageContainer.style.top||imageContainer.style.left)&&(imageContainer.style.top=0,imageContainer.style.left=0),imageContainer.style.width="auto",imageContainer.style.height="auto",imageEnlargement.src=e.dataset.imageFile,imageTitle.textContent=e.dataset.imageName;let t=new URLSearchParams(window.location.search);t.set("image",e.dataset.append),history.replaceState(null,null,`?${t}`)}function imageChangeWrapUp(){imageEnlargement.style.opacity="",imageEnlargement.classList.remove("image-details-appear"),groupListeners([{ele:imagePreviewNavButtons,ev:"click",fun:changeImage,action:"add"}])}function sizedOutAnimation(){imageEnlargement.addEventListener("animationend",function(e){imageEnlargement.classList.remove("size-out")},{once:!0}),imageEnlargement.classList.add("size-out")}function propIsNonZero(e){return""!=e&&"0px"!=e}function firstIsLonger(e,t){return e>t}function imageResize(e,t){imageArea.removeEventListener("pointermove",pointermove_handler);let i=window.getComputedStyle(imageContainer),a=parseInt(i.getPropertyValue("height")),n=parseInt(i.getPropertyValue("width")),r=10;if(e){if(a>=1500||n>=1500)return sizedOutAnimation(),void imageArea.addEventListener("pointermove",pointermove_handler);imageContainer.style.width=`${n+r}px`,imageContainer.style.height=`${a+r}px`}else if(t){if(a<=200||n<=200)return sizedOutAnimation(),void imageArea.addEventListener("pointermove",pointermove_handler);if(propIsNonZero(imageContainer.style.top)||propIsNonZero(imageContainer.style.left)){let e=imageContainer.getBoundingClientRect(),t=imageArea.getBoundingClientRect(),i=sizeCheck(),r=firstIsLonger(a,n),l=r?a/n:n/a,s={shortSide:{range:2,shift:5},longSide:{range:Math.floor(2*l),shift:Math.floor(5*l)}};function o(i){i.size&&(t[i.side1]-i.range<=e[i.side1]&&e[i.side1]<=t[i.side1]+i.range||parseInt(imageContainer.style[i.side1])>i.shift-1?imageContainer.style[i.side1]=`${parseInt(imageContainer.style[i.side1])-i.shift}px`:(t[i.side2]-i.range<=e[i.side2]&&e[i.side2]<=t[i.side2]+i.range||parseInt(imageContainer.style[i.side1])<-1*(i.shift-1))&&(imageContainer.style[i.side1]=`${parseInt(imageContainer.style[i.side1])+i.shift}px`))}r?(Object.assign(s.shortSide,{side1:"left",side2:"right",size:i.width}),Object.assign(s.longSide,{side1:"top",side2:"bottom",size:i.height})):(Object.assign(s.shortSide,{side1:"top",side2:"bottom",size:i.height}),Object.assign(s.longSide,{side1:"left",side2:"right",size:i.width})),o(s.shortSide),o(s.longSide)}imageContainer.style.width=`${n-r}px`,imageContainer.style.height=`${a-r}px`}let l=parseInt(window.getComputedStyle(imageContainer).getPropertyValue("height")),s=parseInt(window.getComputedStyle(imageContainer).getPropertyValue("width")),g=s/l;imageArea.addEventListener("pointermove",pointermove_handler),imageContAdjustment(imageProportion,g,s,l)}function pointerdown_handler(e){evCache.push(e),startingEvCoords.clientX=e.clientX,startingEvCoords.clientY=e.clientY}function pointermove_handler(e){for(var t=0;t<evCache.length;t++)if(e.pointerId==evCache[t].pointerId){evCache[t]=e;break}if(2==evCache.length){var i=Math.abs(Math.sqrt(Math.pow(evCache[1].clientX-evCache[0].clientX,2)+Math.pow(evCache[1].clientY-evCache[0].clientY,2)));prevDiff>0&&imageResize(i>prevDiff,i<prevDiff),prevDiff=i}if(1==evCache.length){stopZoomScroll(e);let t={clientX:e.clientX,clientY:e.clientY},i=sizeCheck();if(!Object.values(i).some(function(e){return e}))return;imageContainer.setAttribute("draggable","true"),moveImage(startingEvCoords,t)}}function pointerup_handler(e){remove_event(e),evCache.length<2&&(prevDiff=-1),1==evCache.length&&(startingEvCoords.clientX=evCache[0].clientX,startingEvCoords.clientY=evCache[0].clientY)}function wheel_handler(e){imageResize(e.deltaY>0,e.deltaY<0)}function remove_event(e){for(var t=0;t<evCache.length;t++)if(evCache[t].pointerId==e.pointerId){evCache.splice(t,1);break}}function sizeCheck(){let e=window.getComputedStyle(imageArea),t={height:parseInt(e.getPropertyValue("height")),width:parseInt(e.getPropertyValue("width"))},i=window.getComputedStyle(imageContainer),a={height:parseInt(i.getPropertyValue("height")),width:parseInt(i.getPropertyValue("width"))},n={height:!1,width:!1};return a.width>t.width?n.width=!0:n.width=!1,a.height>t.height?n.height=!0:n.height=!1,n}function moveImage(e,t){imageArea.removeEventListener("pointermove",pointermove_handler);let i=t.clientX>e.clientX?"right":t.clientX<e.clientX?"left":"stationary",a=t.clientY>e.clientY?"down":t.clientY<e.clientY?"up":"stationary",n=Math.abs(t.clientX-e.clientX),r=Math.abs(t.clientY-e.clientY),o=imageEnlargement.getBoundingClientRect(),l=imageArea.getBoundingClientRect();imageContainer.style.position="relative",imageContainer.style.left=imageContainer.style.left||"0px",imageContainer.style.top=imageContainer.style.top||"0px","left"==i&&o.right>l.right?o.right-n<l.right?imageContainer.style.left=(l.width-o.width)/2+"px":imageContainer.style.left=parseInt(imageContainer.style.left)-n+"px":"right"==i&&o.left<l.left&&(o.left+n>l.left?imageContainer.style.left=(o.width-l.width)/2+"px":imageContainer.style.left=parseInt(imageContainer.style.left)+n+"px"),"up"==a&&o.bottom>l.bottom?o.bottom-r<l.bottom?imageContainer.style.top=(l.height-o.height)/2+"px":imageContainer.style.top=parseInt(imageContainer.style.top)-r+"px":"down"==a&&o.top<l.top&&(o.top+r>l.top?imageContainer.style.top=(o.height-l.height)/2+"px":imageContainer.style.top=parseInt(imageContainer.style.top)+r+"px"),e.clientX=t.clientX,e.clientY=t.clientY,imageArea.addEventListener("pointermove",pointermove_handler)}const portfolioNavArray=[...document.getElementById("portfolioSubnav").getElementsByTagName("a")],galleriesArray=[...document.getElementsByClassName("gallery")],imagePreview=document.getElementById("image-details"),previewHeader=imagePreview.getElementsByTagName("header")[0],imageTitle=previewHeader.querySelector("#image-title"),closeBox=previewHeader.querySelector("#closebox"),imageArea=imagePreview.querySelector("#image-display"),imageContainer=imageArea.querySelector("#image-container"),imageEnlargement=imageContainer.querySelector("#image-image"),imagePreviewNavButtons=[...this.document.getElementsByClassName("hitbox")],previousButton=imagePreviewNavButtons.filter(e=>"previousButtonImage"==e.id)[0],nextButton=imagePreviewNavButtons.filter(e=>"nextButtonImage"==e.id)[0];var imageProportion,currentImageIndex,currentTab=portfolioNavArray.filter(e=>e.classList.contains("selectedGallery"))[0],currentGallery=galleriesArray.filter(e=>e.classList.contains("showingGallery"))[0],galleryImages=[...currentGallery.getElementsByClassName("galleryImages")[0].children],lastGalleryIndex=galleryImages.length-1,startingEvCoords={};window.onload=function(){""!=window.location.search&&parseURL()};const groupListeners=e=>{for(let t in e){let i=e[t].opts||{};Array.isArray(e[t].ele)?e[t].ele.forEach(a=>{groupListeners([{ele:a,ev:e[t].ev,fun:e[t].fun,action:e[t].action,opts:i}])}):Array.isArray(e[t].ev)?e[t].ev.forEach(a=>{groupListeners([{ele:e[t].ele,ev:a,fun:e[t].fun,action:e[t].action,opts:i}])}):e[t].ele[`${e[t].action}EventListener`](e[t].ev,e[t].fun,i)}};var evCache=new Array,prevDiff=-1;groupListeners([{ele:portfolioNavArray,ev:"click",fun:changeGallery,action:"add"},{ele:galleryImages,ev:"click",fun:openImagePreview,action:"add"}]);